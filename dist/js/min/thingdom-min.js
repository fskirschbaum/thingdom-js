(function(){"use strict";var root=this,previous_thingdom=root.Thingdom;!function($_$){var win=window,xhrs=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("MSXML2.XMLHTTP.3.0")},function(){return new ActiveXObject("MSXML2.XMLHTTP")}],_xhrf=null,hasOwnProperty=Object.prototype.hasOwnProperty,nativeForEach=Array.prototype.forEach,_each=function(t,e,r){if(null!==t)if(nativeForEach&&t.forEach===nativeForEach)t.forEach(e,r);else if(t.length===+t.length){for(var n=0,o=t.length;o>n;n++)if(n in t&&e.call(r,t[n],n,t)===breaker)return}else for(var a in t)if(hasOwnProperty.call(t,a)&&e.call(r,t[a],a,t)===breaker)return},_extend=function(t){return _each(Array.prototype.slice.call(arguments,1),function(e){for(var r in e)void 0!==e[r]&&(t[r]=e[r])}),t};$_$.xhr=function(){if(null!==_xhrf)return _xhrf();for(var t=0,e=xhrs.length;e>t;t++)try{var r=xhrs[t],n=r();if(null!==n)return _xhrf=r,n}catch(o){continue}return function(){}},$_$._xhrResp=function(xhr){switch(xhr.getResponseHeader("Content-Type").split(";")[0]){case"text/xml":return xhr.responseXML;case"text/json":case"application/json":case"text/javascript":case"application/javascript":case"application/x-javascript":return win.JSON?JSON.parse(xhr.responseText):eval(xhr.responseText);default:return xhr.responseText}},$_$._formData=function(t){var e=[],r=/%20/g;for(var n in t)e.push(encodeURIComponent(n).replace(r,"+")+"="+encodeURIComponent(t[n].toString()).replace(r,"+"));return e.join("&")},$_$.ajax=function(t){var e=$_$.xhr(),r=0,n;t=_extend({userAgent:"XMLHttpRequest",lang:"en",type:"GET",data:null,dataType:"application/x-www-form-urlencoded"},t),t.timeout&&(n=setTimeout(function(){e.abort(),t.timeoutFn&&t.timeoutFn(t.url)},t.timeout)),e.onreadystatechange=function(){4===e.readyState?(n&&clearTimeout(n),e.status<300?t.success&&t.success($_$._xhrResp(e)):t.error&&t.error(e,e.status,e.statusText),t.complete&&t.complete(e,e.statusText)):t.progress&&t.progress(++r)};var o=t.url,a=null,i="POST"===t.type||"PUT"===t.type;if(!i&&t.data&&(o+="?"+$_$._formData(t.data)),e.open(t.type,o),i){var s=t.dataType.indexOf("json")>=0;a=s?JSON.stringify(t.data):$_$._formData(t.data),e.setRequestHeader("Content-Type",s?"application/json":"application/x-www-form-urlencoded")}e.send(a)}}(root);var ThingdomIO=root.Thingdom=function(){var t=this,e="https://api.thingdom.io/1.1/",r=function(t,r){root.ajax({url:e+t,withCredentials:!0,type:"POST",dataType:"json",data:r,success:function(){},error:function(){}})},n=function(){var t="",e=document.getElementsByTagName("script"),r="",n=null,o=function(t){for(var e=o.options,r=e.parser[e.strictMode?"strict":"loose"].exec(t),n={},a=14;a--;)n[e.key[a]]=r[a]||"";return n[e.q.name]={},n[e.key[12]].replace(e.q.parser,function(t,r,o){r&&(n[e.q.name][r]=o)}),n};o.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},o.options.strictMode=!0;for(var a=0;a<e.length;++a)if(r=e[0].getAttribute("src"),n=o(r),"thingdom.js"===n.file||"thingdom.min.js"===n.file){try{t=n.queryKey.api_secret}catch(i){}break}return t};t.apiSecret=n(),r("token",{api_secret:t.apiSecret}),t.noConflict=function(){return root.previous_thingdom=previous_thingdom,t}},Thingdom=function(){return Thingdom=new ThingdomIO}();Thingdom.ThingdomIO=Thingdom,root.Thingdom=Thingdom}).call(this);
//# sourceMappingURL=./thingdom-min.js.map